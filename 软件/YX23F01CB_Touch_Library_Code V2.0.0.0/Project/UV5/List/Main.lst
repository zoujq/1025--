C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Output\Main.obj
COMPILER INVOKED BY: F:\Keil\C51\BIN\C51.EXE ..\..\User\Main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\..\Application;..\..\U
                    -ser\INC;..\..\Libraries;..\..\Libraries;..\..\User\INC) DEBUG OBJECTEXTEND PRINT(.\List\Main.lst) TABS(2) OBJECT(.\Outpu
                    -t\Main.obj)

line level    source

   1          
   2          //================================================================================
   3          #define  ALLOCATE_EXTERN
   4          #include "YX23F01CB.h"
   5          #include "YX23F01CB_SYS.h"
   6          #include "YX23F01CB_IO_INIT.h"
   7          #include "YX23F01CB_GeneralKey_Touch_Lib_V2.00\YX23F01CB_GeneralKey_Touch_Lib.h"
   8          #include "YX23F01CB_GeneralKey_Touch_Lib_V2.00\YX23F01CB_GeneralKey_Touch_Auxiliary.h"
   9          #include "YX23F01CB_TouchUartDebug_Lib_V2.00\YX23F01CB_TouchUartDebug_Lib_CFG.h"
  10          #include "YX23F01CB_TouchUartDebug_Lib_V2.00\YX23F01CB_TouchUartDebug_Lib.h"
  11          #include "YX23F01CB_PORT_MAP.h"
  12          #include <stdio.h>
  13          
  14          //=======================================public data=====================================
  15          //display buffer
  16          char g_shu_ma_guan1=0;
  17          char g_shu_ma_guan2=0;
  18          char g_touch_led1=0;
  19          char g_touch_led2=0;
  20          char g_touch_led3=0;
  21          //work status
  22          char g_work_mode=0;
  23          char g_feng_su=0;
  24          char g_yao_tou=0;
  25          char g_ding_shi=0;
  26          u16  g_ding_shi_timer=0;
  27          char g_xi_ping=0;
  28          
  29          //=======================================delay============================================================
  30          void Delay_50us(unsigned int n)    
  31          {
  32   1        unsigned char i;
  33   1        while(n--)
  34   1        {
  35   2          for(i=0;i<71;i++);
  36   2        }
  37   1      }
  38          void Delay_ms(unsigned int delay_nms)
  39          {
  40   1        while(delay_nms--)
  41   1        {
  42   2          Delay_50us(20);
  43   2        }
  44   1      }
  45          //===================================================================================================
  46          //=======================================printf===========================================================
             -=
  47          #define PRINTF_BAUDRATE     9600   
  48          #define TX  P2_0
  49          void init_printf()
  50          {
  51   1        P2M0 = 0xC1;                //
  52   1        
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 2   

  53   1        TXD_MAP = 0x20;           //TXD
  54   1        
  55   1        T4CON = 0x06;           //
  56   1      
  57   1        SCON2 = 0x02;   // uart mode 1
  58   1        
  59   1        T4 = 65536.5 - (SYSCLK_FOSC / 16 / PRINTF_BAUDRATE); //
  60   1      
  61   1      
  62   1      }
  63          
  64          char putchar (char c)
  65          {
  66   1        SBUF = c;
  67   1      
  68   1        while(!TI);
  69   1      
  70   1        TI = 0;
  71   1          return 0;
  72   1      }
  73          //===================================================================================================
  74          #define DISPLAY_A  P2_1
  75          #define DISPLAY_B  P2_0
  76          #define DISPLAY_C  P0_1
  77          #define DISPLAY_D  P0_0
  78          #define DISPLAY_E  P2_7
  79          #define DISPLAY_F  P2_6
  80          #define DISPLAY_G  P2_5
  81          //
  82          #define DISPLAY_COM1 P3_4
  83          #define DISPLAY_COM2 P2_3
  84          #define TOUCH_LED_COM P2_2
  85          
  86          void init_display()
  87          {
  88   1        P2M1=GPIO_Out_PP;
  89   1        P2M0=GPIO_Out_PP;
  90   1        P0M1=GPIO_Out_PP;
  91   1        P0M0=GPIO_Out_PP;
  92   1        P2M7=GPIO_Out_PP;
  93   1        P2M6=GPIO_Out_PP;
  94   1        P2M5=GPIO_Out_PP;
  95   1      
  96   1        P3M4=GPIO_Out_PP;
  97   1        P2M3=GPIO_Out_PP;
  98   1        P2M2=GPIO_Out_PP;
  99   1      
 100   1        DISPLAY_A=0;
 101   1        DISPLAY_B=0;
 102   1        DISPLAY_C=0;
 103   1        DISPLAY_D=0;
 104   1        DISPLAY_E=0;
 105   1        DISPLAY_F=0;
 106   1        DISPLAY_G=0;
 107   1      
 108   1        DISPLAY_COM1=1;
 109   1        DISPLAY_COM2=1;
 110   1        TOUCH_LED_COM=1;
 111   1      }
 112          
 113          void display_close()
 114          {
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 3   

 115   1        DISPLAY_A=0;
 116   1        DISPLAY_B=0;
 117   1        DISPLAY_C=0;
 118   1        DISPLAY_D=0;
 119   1        DISPLAY_E=0;
 120   1        DISPLAY_F=0;
 121   1        DISPLAY_G=0;
 122   1      
 123   1        DISPLAY_COM1=1;
 124   1        DISPLAY_COM2=1;
 125   1        TOUCH_LED_COM=1;
 126   1      
 127   1      }
 128          void display(char c,char b)
 129          {
 130   1        DISPLAY_COM1=1;
 131   1        DISPLAY_COM2=1;
 132   1        TOUCH_LED_COM=1;
 133   1        switch(c)
 134   1        {
 135   2          case 0:
 136   2            DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 137   2            break;
 138   2          case 1:
 139   2            DISPLAY_A=0;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 140   2            break;
 141   2          case 2:
 142   2            DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=0;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=0;  DISPLAY_G=1;
 143   2            break;
 144   2          case 3:
 145   2            DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=1;
 146   2            break;
 147   2          case 4:
 148   2            DISPLAY_A=0;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=1;
 149   2            break;
 150   2          case 5:
 151   2            DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=1;
 152   2            break;
 153   2          case 6:
 154   2            DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 155   2            break;
 156   2          case 7:
 157   2            DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 158   2            break;
 159   2          case 8:
 160   2            DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 161   2            break;
 162   2          case 9:
 163   2            DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=1;
 164   2            break;
 165   2          case 'H':
 166   2            DISPLAY_A=0;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 167   2            break;
 168   2          case 'F':
 169   2            DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 170   2            break;
 171   2          default:
 172   2            DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 173   2            break;
 174   2          
 175   2        }
 176   1        if(b==1)
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 4   

 177   1        {
 178   2          DISPLAY_COM1=0;
 179   2          DISPLAY_COM2=1;
 180   2          TOUCH_LED_COM=1;
 181   2        }
 182   1        else if(b==2)
 183   1        {
 184   2          DISPLAY_COM1=1;
 185   2          DISPLAY_COM2=0;
 186   2          TOUCH_LED_COM=1;
 187   2        }
 188   1        else if(b==3)
 189   1        {
 190   2          DISPLAY_A=0;  
 191   2          DISPLAY_B=0;  
 192   2          DISPLAY_C=0;  
 193   2          DISPLAY_D=0;  
 194   2          DISPLAY_E=0;  
 195   2          DISPLAY_F=0;  
 196   2          DISPLAY_G=0;
 197   2          if(g_touch_led1==1)
 198   2          {
 199   3            DISPLAY_B=1;
 200   3          }
 201   2          if(g_touch_led2==1)
 202   2          {
 203   3            DISPLAY_C=1;
 204   3          }
 205   2          if(g_touch_led3==1)
 206   2          {
 207   3            DISPLAY_D=1;
 208   3          }
 209   2          DISPLAY_COM1=1;
 210   2          DISPLAY_COM2=1;
 211   2          TOUCH_LED_COM=0;
 212   2        }
 213   1        
 214   1      }
 215          void display_flush()
 216          {
 217   1        static char tt=0;
 218   1        if(g_xi_ping==0)
 219   1        {
 220   2          if(tt==1)
 221   2          {
 222   3            display(g_shu_ma_guan1,1);
 223   3          }
 224   2          else if(tt==2)
 225   2          {
 226   3            display(g_shu_ma_guan2,2);
 227   3          }
 228   2          else if(tt==3)
 229   2          {
 230   3            display('X',3);
 231   3            tt=0;
 232   3          }
 233   2          tt++;
 234   2        }
 235   1        else
 236   1        {
 237   2          display_close();
 238   2        }
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 5   

 239   1        
 240   1      
 241   1      }
 242          //===================================================================================================
 243          #define BUZZ P2_4
 244          void  buzzer()
 245          {
 246   1        static char inited=0;
 247   1        int i=0;
 248   1        // if(inited==0)
 249   1        // {
 250   1          P2M4 = 0xC2;                        //P24设置为推挽输出
 251   1          PWM3_MAP = 0x24;          //PWM3映射P03口
 252   1          PWM3P = 0x20;           //PWM周期为0xFF
 253   1          PWM3D = 0x10;           //PWM占空比设置
 254   1          PWM3C = 0x97;             //使能PWM3，关闭中断，允许输出，时钟4分频
 255   1          inited=1;
 256   1        // }  
 257   1        PWM3C = 0x97; 
 258   1        Delay_ms(100);
 259   1        PWM3C = 0x07;
 260   1        P2M4=GPIO_In_AN;
 261   1        
 262   1      }
 263          //================================================================================
 264          void touch_key_check()
 265          {
 266   1        static char touched=0;
 267   1        if(TouchKeyFlag)
 268   1        {
 269   2          if(touched==0)
 270   2          {
 271   3            touched=1;
 272   3            if(TouchKeyFlag & 0x0800L)
 273   3            {
 274   4              if(g_work_mode==0)
 275   4              {
 276   5                g_work_mode=1;
 277   5                g_ding_shi=0;
 278   5                g_feng_su=1;
 279   5                g_yao_tou=0;          
 280   5              }
 281   4              else
 282   4              {
 283   5                g_work_mode=0;
 284   5                g_ding_shi=0;
 285   5                g_feng_su=0;
 286   5                g_yao_tou=0;
 287   5                g_xi_ping=0;
 288   5              }
 289   4      
 290   4            }
 291   3            if(g_work_mode==1)
 292   3            {
 293   4              buzzer();
 294   4              if(TouchKeyFlag & 0x0400L)
 295   4              {
 296   5                if(g_feng_su==1)
 297   5                {
 298   6                  g_feng_su=2;
 299   6                }
 300   5                else if(g_feng_su==2)
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 6   

 301   5                {
 302   6                  g_feng_su=3;
 303   6                }
 304   5                else
 305   5                {
 306   6                  g_feng_su=1;
 307   6                }
 308   5              }
 309   4              else if(TouchKeyFlag & 0x0200L)
 310   4              {
 311   5                if(g_yao_tou==0)
 312   5                {
 313   6                  g_yao_tou=1;
 314   6                }
 315   5                else
 316   5                {
 317   6                  g_yao_tou=0;
 318   6                }
 319   5              }
 320   4              else if(TouchKeyFlag & 0x0100L)
 321   4              {
 322   5                if(g_ding_shi<9)
 323   5                {
 324   6                  g_ding_shi++;
 325   6                }
 326   5                else
 327   5                {
 328   6                  g_ding_shi=0;
 329   6                }
 330   5                g_ding_shi_timer=g_ding_shi*60;
 331   5              }
 332   4            }
 333   3          }
 334   2          
 335   2        }
 336   1        else
 337   1        {
 338   2          touched=0;
 339   2        }
 340   1      }
 341          
 342          //========================================NEC=====================================
 343          u8 nec_timer=0; 
 344          u8 nec_end_flag=0;
 345          u8 nec_start_flag=0;
 346          xdata u8 nec_buff[34];
 347          u8 nec_index=0;
 348          xdata u8 nec_data[4];
 349          u16 nec_doing=0;
 350          void init_timer0()
 351          {
 352   1        TCON1 = 0x00;           //
 353   1        TMOD = 0x00;            //
 354   1        
 355   1        TH0 = 0xFF;
 356   1        TL0 = 0x7B;             //100us
 357   1        IE |= 0x02;             //
 358   1        TCON |= 0x10;           //
 359   1          
 360   1      }
 361          void init_ext_int_17()
 362          {
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 7   

 363   1        P3M5 = 0x69;            //P35设置为带SMT上拉输入
 364   1        PITS4 |= 0x04;          //INT17下降沿  
 365   1        PINTE2 = 0x02;
 366   1        IE2 |= 0x01;              //打开INT17中断
 367   1        
 368   1      }
 369          void ISR_INT_TIME0(void) interrupt TIMER0_VECTOR  //时基100us
 370          {
 371   1        static u32 tt=0;
 372   1      
 373   1        nec_timer++;
 374   1        if(nec_timer>150)
 375   1        {
 376   2          nec_end_flag=1;
 377   2          nec_timer=0;
 378   2        }
 379   1        if(tt%50)//5ms
 380   1        {
 381   2          display_flush();
 382   2        }
 383   1        
 384   1        if(tt++>600000)
 385   1        {
 386   2          tt=0;
 387   2          if(g_ding_shi_timer>0)
 388   2          {
 389   3            g_ding_shi_timer--;
 390   3            g_ding_shi= g_ding_shi_timer/60+1;
 391   3            if(g_ding_shi_timer==0)
 392   3            {
 393   4              g_work_mode=0;
 394   4              g_ding_shi=0;
 395   4            } 
 396   3              
 397   3          }
 398   2        }
 399   1        nec_doing++;
 400   1      } 
 401          
 402          
 403          void ISR_INT16_17(void)  interrupt INT16_17_VECTOR
 404          {
 405   1        PINTF2 &=~ 0x02;        //清除INT17中断标志位    
 406   1        if(nec_start_flag)
 407   1        {
 408   2          if(nec_timer>105)
 409   2          {
 410   3            nec_index=0;
 411   3          }
 412   2          nec_buff[nec_index]=nec_timer;
 413   2          nec_timer=0;
 414   2          nec_index++;
 415   2          if(nec_index>33)
 416   2          {
 417   3            nec_index=0;
 418   3          }
 419   2          nec_end_flag=0;
 420   2        }
 421   1        else
 422   1        {
 423   2          nec_start_flag=1;
 424   2          nec_timer=0;
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 8   

 425   2        }
 426   1      }
 427          void nec_chu_li();
 428          void nec_decode()
 429          {
 430   1        if(nec_index && nec_end_flag)
 431   1        {
 432   2          nec_data[0]=(nec_buff[1]<0x0F ? 0 : 1)<<0 |
 433   2                (nec_buff[2]<0x0F ? 0 : 1)<<1 |
 434   2                (nec_buff[3]<0x0F ? 0 : 1)<<2 |
 435   2                (nec_buff[4]<0x0F ? 0 : 1)<<3 |
 436   2                (nec_buff[5]<0x0F ? 0 : 1)<<4 |
 437   2                (nec_buff[6]<0x0F ? 0 : 1)<<5 |
 438   2                (nec_buff[7]<0x0F ? 0 : 1)<<6 |
 439   2                (nec_buff[8]<0x0F ? 0 : 1)<<7 ;
 440   2          nec_data[1]=(nec_buff[9]<0x0F ? 0 : 1)<<0 |
 441   2                (nec_buff[10]<0x0F ? 0 : 1)<<1 |
 442   2                (nec_buff[11]<0x0F ? 0 : 1)<<2 |
 443   2                (nec_buff[12]<0x0F ? 0 : 1)<<3 |
 444   2                (nec_buff[13]<0x0F ? 0 : 1)<<4 |
 445   2                (nec_buff[14]<0x0F ? 0 : 1)<<5 |
 446   2                (nec_buff[15]<0x0F ? 0 : 1)<<6 |
 447   2                (nec_buff[16]<0x0F ? 0 : 1)<<7 ;
 448   2          nec_data[2]=(nec_buff[17]<0x0F ? 0 : 1)<<0 |
 449   2                (nec_buff[18]<0x0F ? 0 : 1)<<1 |
 450   2                (nec_buff[19]<0x0F ? 0 : 1)<<2 |
 451   2                (nec_buff[20]<0x0F ? 0 : 1)<<3 |
 452   2                (nec_buff[21]<0x0F ? 0 : 1)<<4 |
 453   2                (nec_buff[22]<0x0F ? 0 : 1)<<5 |
 454   2                (nec_buff[23]<0x0F ? 0 : 1)<<6 |
 455   2                (nec_buff[24]<0x0F ? 0 : 1)<<7 ;
 456   2          nec_data[3]=(nec_buff[25]<0x0F ? 0 : 1)<<0 |
 457   2                (nec_buff[26]<0x0F ? 0 : 1)<<1 |
 458   2                (nec_buff[27]<0x0F ? 0 : 1)<<2 |
 459   2                (nec_buff[28]<0x0F ? 0 : 1)<<3 |
 460   2                (nec_buff[29]<0x0F ? 0 : 1)<<4 |
 461   2                (nec_buff[30]<0x0F ? 0 : 1)<<5 |
 462   2                (nec_buff[31]<0x0F ? 0 : 1)<<6 |
 463   2                (nec_buff[32]<0x0F ? 0 : 1)<<7 ;
 464   2          nec_index=0;
 465   2          nec_chu_li(); 
 466   2          
 467   2          putchar(nec_data[0]);
 468   2          putchar(nec_data[1]);
 469   2          putchar(nec_data[2]);
 470   2          putchar(nec_data[3]);
 471   2          
 472   2          nec_data[0]=0;
 473   2          nec_data[1]=0;
 474   2          nec_data[2]=0;
 475   2          nec_data[3]=0;
 476   2        }
 477   1      }
 478          void nec_chu_li()
 479          {
 480   1        if(nec_data[0]==0 && nec_data[1]==0xFF)
 481   1        {
 482   2          if(nec_doing<10000)
 483   2          {
 484   3            return;
 485   3          }
 486   2          nec_doing=0;
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 9   

 487   2          if(nec_data[2]==0x46)
 488   2          {
 489   3            if(g_work_mode==0)
 490   3            {
 491   4              g_work_mode=1;
 492   4              g_ding_shi=0;
 493   4              g_feng_su=1;
 494   4              g_yao_tou=0;
 495   4            }
 496   3            else
 497   3            {
 498   4              g_work_mode=0;
 499   4              g_ding_shi=0;
 500   4              g_feng_su=0;
 501   4              g_yao_tou=0;
 502   4              g_xi_ping=0;
 503   4            }
 504   3      
 505   3          }
 506   2          if(g_work_mode==1)
 507   2          {
 508   3            buzzer();
 509   3            if(nec_data[2]==0x44)
 510   3            {
 511   4              if(g_feng_su==1)
 512   4              {
 513   5                g_feng_su=2;
 514   5              }
 515   4              else if(g_feng_su==2)
 516   4              {
 517   5                g_feng_su=3;
 518   5              }
 519   4              else
 520   4              {
 521   5                g_feng_su=1;
 522   5              }
 523   4            }
 524   3            else if(nec_data[2]==0x43)
 525   3            {
 526   4              if(g_yao_tou==0)
 527   4              {
 528   5                g_yao_tou=1;
 529   5              }
 530   4              else
 531   4              {
 532   5                g_yao_tou=0;
 533   5              }
 534   4            }
 535   3            else if(nec_data[2]==0x16)
 536   3            {
 537   4              if(g_ding_shi<9)
 538   4              {
 539   5                g_ding_shi++;
 540   5              }
 541   4              else
 542   4              {
 543   5                g_ding_shi=0;
 544   5              }
 545   4              g_ding_shi_timer=g_ding_shi*60;
 546   4            }
 547   3            
 548   3          }
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 10  

 549   2          if(nec_data[2]==0x0D)
 550   2          {
 551   3            if(g_xi_ping==0)
 552   3            {
 553   4              g_xi_ping=1;
 554   4            }
 555   3            else
 556   3            {
 557   4              g_xi_ping=0;
 558   4            }
 559   3            
 560   3          }
 561   2        }
 562   1        
 563   1        
 564   1      }
 565          //===============================================================================
 566          #define FAN_YAO_TOU P0_7
 567          #define FAN_DW1 P1_3
 568          #define FAN_DW2 P1_2
 569          #define FAN_DW3 P1_1
 570          void init_work()
 571          {
 572   1        P0M7=GPIO_Out_PP;
 573   1        P1M3=GPIO_Out_PP;
 574   1        P1M2=GPIO_Out_PP;
 575   1        P1M1=GPIO_Out_PP;
 576   1      }
 577          void work_check()
 578          {
 579   1        if(g_work_mode==1)
 580   1        {
 581   2          g_touch_led1=1;
 582   2          if(g_yao_tou)
 583   2          {
 584   3            g_touch_led2=1;
 585   3            FAN_YAO_TOU=1;
 586   3          }
 587   2          else
 588   2          {
 589   3            g_touch_led2=0;
 590   3            FAN_YAO_TOU=0;
 591   3          }
 592   2          if(g_ding_shi_timer>0)
 593   2          {
 594   3            g_touch_led3=1;
 595   3          }
 596   2          else
 597   2          {
 598   3            g_touch_led3=0;
 599   3          }
 600   2          if(g_feng_su==1)
 601   2          {
 602   3            FAN_DW1=1;
 603   3            FAN_DW2=0;
 604   3            FAN_DW3=0;
 605   3          }
 606   2          else if(g_feng_su==2)
 607   2          {
 608   3            FAN_DW1=0;
 609   3            FAN_DW2=1;
 610   3            FAN_DW3=0;
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 11  

 611   3          }
 612   2          else if(g_feng_su==3)
 613   2          {
 614   3            FAN_DW1=0;
 615   3            FAN_DW2=0;
 616   3            FAN_DW3=1;
 617   3          }
 618   2      
 619   2          if(g_ding_shi>1)
 620   2          {
 621   3            g_shu_ma_guan1=g_ding_shi;
 622   3            g_shu_ma_guan2='H';
 623   3          }
 624   2          else if(g_ding_shi==1)
 625   2          {
 626   3            g_shu_ma_guan1=g_ding_shi_timer/10;
 627   3            g_shu_ma_guan2=g_ding_shi_timer%10;
 628   3          }
 629   2          else
 630   2          {
 631   3            g_shu_ma_guan1=g_feng_su;
 632   3            g_shu_ma_guan2='F';
 633   3          }
 634   2      
 635   2        }
 636   1        else
 637   1        {
 638   2          g_feng_su=0;
 639   2          g_yao_tou=0;
 640   2          g_ding_shi=0;
 641   2          g_ding_shi_timer=0;
 642   2          g_shu_ma_guan1=0;
 643   2          g_shu_ma_guan2=0;
 644   2          g_touch_led1=0;
 645   2          g_touch_led2=0;
 646   2          g_touch_led3=0;
 647   2        }
 648   1      }
 649          
 650          
 651          //================================================================================
 652          void main()
 653          {
 654   1        SystemInit();           //16M
 655   1        FREQ_CLK = 0x10;
 656   1        IO_Init();
 657   1      
 658   1        EA = 1;
 659   1        CTK_Init(); 
 660   1        
 661   1        //init_printf();
 662   1        init_display();
 663   1        init_timer0();
 664   1        init_ext_int_17();
 665   1        init_work();
 666   1        
 667   1      
 668   1        while(1)
 669   1        {
 670   2          if(OneCycleScanDone)
 671   2          {
 672   3            Touch_Signal_Handle();
C51 COMPILER V9.56.0.0   MAIN                                                              11/22/2020 21:53:33 PAGE 12  

 673   3            OneCycleScanDone = 0;
 674   3          }
 675   2      
 676   2          touch_key_check();
 677   2          nec_decode();
 678   2          work_check();
 679   2          Delay_ms(10);
 680   2      
 681   2        }
 682   1      }
 683          
 684          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2192    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     38    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     25       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
